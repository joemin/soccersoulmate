define(['frameworks/bundle'],function () {;(function($,w,d) {var horizontalModel=fifa.model.extend({initialize:function(options) {var _this=this;fifa.model.prototype.initialize.apply(_this,[options]);},onValidateCollection:function() {var _this=this,$collectionScript=$('script[type="horizontal/navigation"]'),$collection;if(!$collectionScript.length) { return;}try {$collection=eval('(' + $collectionScript.html().trim() + ')');}catch (e) {return;}_this.triggerMe('validCollection',$collection);},name:'horizontal',view_name:'horizontal:view'});w.models.horizontal=new horizontalModel({bind:['validateCollection']});}(window.jQuery||window.jm,window,document));;(function($,w,d) {var horizontalView=fifa.view.extend({$contentWrapContainer:null,_wrap:null,_fjs:null,$canonical:null,actual_idx:-1,$collection:null,has_mouseover:false,assetsImg:'http://img.fifa.com',path_name:null,initialize:function(options) {var _this=this;_this.path_name=_this.getCleanPathName();try {d.createEvent("TouchEvent");$('#wrap').on('click.touch',function(e) {var $target=$(e.currentTarget);if(!$target.is(_this.$el)) {_this.$el.removeClass('hover');}});}catch (e) {_this.has_mouseover=true;}fifa.view.prototype.initialize.apply(_this,[options]);_this.triggerModel('validateCollection');},getCleanPathName:function() {var path=w.location.pathname;if(path[path.length - 1]==='/') {path += 'index.html';}else if(path.lastIndexOf('.htm')===-1) {path += '/index.html';}return path;},getCacheKey:function(link) {return ['horizontal.nav',link].join('.');},getPageName:function(path) {path=path||this.path_name;var lastIdx=path.lastIndexOf('/') + 1,pagename=null;if(lastIdx>1) {pagename=path.substr(lastIdx);}return pagename||'index.html';},getFolder:function(path) {path=path||this.path_name;var lastIdx=path.lastIndexOf('/') + 1,folder=null;if(lastIdx===1) {folder=path + '/';}else {folder=path.substr(0,lastIdx);}return folder;},horizontalOnValidCollection:function($collection) {var _this=this,folder=_this.getFolder(),i=0,l=$collection.length,$obj,link;_this.$collection=$collection;for (i; i<l; i++) {$obj=$collection[i];link=$obj.link||'',link_folder=link.substr(0,link.lastIndexOf('/') + 1);if(link_folder&&link_folder===folder) {_this.actual_idx=i;fifa.cacheMap.set(_this.getCacheKey(link_folder),d.documentElement.outerHTML);_this.$el.addClass('nav-type-' + $obj.type);_this.triggerMe([$obj.type,'Prepare'].join(''),$collection);}}if(_this.actual_idx===-1) { return;}_this.triggerMe('wrapPrepare',$collection,_this.actual_idx);_this._wrap=d.getElementById('wrap');_this._fjs=d.getElementsByTagName('script')[1];_this.$contentWrapContainer=$('#content-wrap>.container');_this.$el.removeClass('hidden');},events:{'click':'onNavClick','touchend':'onNavClick'},onWrapPrepare:function($collection,idx) {var _this=this,$item_title=_this.$el.find('.horizontal-items-title'),nav_obj=$collection[idx];$item_title.find('.horizontal-items-title-content').find('a').attr('href',nav_obj.type_link).text(nav_obj.title);$item_title.find('.total').text($collection.length);},onTeamsPrepare:function() {var _this=this,prev_item=_this.getPrevItem(),next_item=_this.getNextItem(),prev_nav_key='.horizontal-nav-fixed-prev',prev_nav_content_key=prev_nav_key + '.content',next_nav_key='.horizontal-nav-fixed-next',next_nav_content_key=next_nav_key + '.content',$prev_item=(fifa.cacheMap.get(prev_nav_key)||fifa.cacheMap.set(prev_nav_key,_this.$el.filter('.horizontal-nav-fixed-prev'))),$next_item=(fifa.cacheMap.get(next_nav_key)||fifa.cacheMap.set(next_nav_key,_this.$el.filter('.horizontal-nav-fixed-next'))),$prev_content=(fifa.cacheMap.get(prev_nav_content_key)||fifa.cacheMap.set(prev_nav_content_key,$prev_item.find('.horizontal-items-content'))),$next_content=(fifa.cacheMap.get(next_nav_content_key)||fifa.cacheMap.set(next_nav_content_key,$next_item.find('.horizontal-items-content')));$prev_item.find('.actual-counter').text(_this.getPrevIdx() + 1);$next_item.find('.actual-counter').text(_this.getNextIdx() + 1);_this.setTeamContent($prev_content,prev_item);_this.setTeamContent($next_content,next_item);},setTeamContent:function($nav_item,nav_obj) {$nav_item.html(['<div class="img-wrap"><img width="64" height="42" src="',this.assetsImg,'/images/flags/4/',nav_obj.countrycode.toLowerCase(),'.png"/></div><span class="name">',nav_obj.webname,'</span>'].join(''));},getPrevIdx:function(idx) {var _this=this;idx=idx!==undefined ? idx:_this.actual_idx - 1;return idx>-1 ? idx:_this.$collection.length - 1;},getNextIdx:function(idx) {var _this=this;idx=idx!==undefined ? idx:_this.actual_idx + 1;return idx<_this.$collection.length ? idx:0;},getPrevItem:function(idx) {var _this=this,item;idx=_this.getPrevIdx(idx);item=_this.$collection[idx];if(!item) {item=_this.$collection[_this.$collection.length - 1];}return item;},getNextItem:function(idx) {var _this=this,item;idx=_this.getNextIdx(idx);item=_this.$collection[idx];if(!item) {item=_this.$collection[0];}return item;},onNavClick:function(event) {var _this=this,$this=$(event.currentTarget),nav_obj;if($(event.target).is('a[href!="#"]')) { return;}event.preventDefault();if($this.hasClass('hover')) {_this.triggerMe('pageLoad',_this.$collection[_this.actual_idx]);$this.removeClass('hover');return;}if($this.is('.horizontal-nav-fixed-prev')) {nav_obj=_this.getPrevItem(--_this.actual_idx);}else {nav_obj=_this.getNextItem(++_this.actual_idx);}if(_this.actual_idx<0) {_this.actual_idx=_this.$collection.length - 1;}else if(_this.actual_idx>=_this.$collection.length) {_this.actual_idx=0;}if(!nav_obj.link) { return;}if(!_this.has_mouseover) {_this.$el.removeClass('hover');$this.addClass('hover');return;}_this.triggerMe('pageLoad',nav_obj);},xhr:null,progress_tm:null,incProgressBar:function() {var _this=this;if(_this.progress_tm) { clearTimeout(_this.progress_tm);}NProgress.inc();_this.progress_tm=setTimeout(function(s) {clearTimeout(s);_this.incProgressBar();},600);},stopProgressBar:function() {clearTimeout(this.progress_tm);},onPageLoad:function(nav_obj) {var _this=this,path=nav_obj.link,cached_key=_this.getCacheKey(path.substr(0,path.lastIndexOf('/') + 1)),cached_data=fifa.cacheMap.get(cached_key),url=[_this.getFolder(path),_this.getPageName()].join('');NProgress.start();fillDataCallback=function(data) {var $data=$(data),$meta=$data.filter('meta'),$title=$data.filter('title'),$link=$data.filter('link[rel="canonical"]'),_ref=fifa.get$PageHeader().find('.active>a').attr('model-ref'),parentNode=_this._fjs.parentNode;_this._wrap.innerHTML=($data.filter('#wrap').html());_this.triggerMe([nav_obj.type,'Prepare'].join(''));$('link[rel="canonical"]').attr('href',$link.attr('href'));$in_meta=$('meta');$meta.each(function() {var __this=this,prop=__this.getAttribute('property'),name=__this.getAttribute('name'),content=__this.getAttribute('content'),$f_meta=null;if(prop) {$f_meta=$in_meta.filter('[property="' + prop + '"]')}else if(name) {$f_meta=$in_meta.filter('[name="' + name + '"]');}if($f_meta!=null) {$f_meta.attr('content',content);}});_this.$el.fadeIn();_this.$contentWrapContainer.css('min-height','');fifa.dispatcher.trigger('core:reinit');CallbackManager.ApplyCallbacks('comments','init');fifa.dispatcher.trigger('history:pushState',{ ref:_ref},$title.text(),url);_this.stopProgressBar();NProgress.done();};if(cached_data) {fillDataCallback(cached_data);}else {if(_this.xhr) { _this.xhr.abort();}_this.incProgressBar();_this.$contentWrapContainer.css('min-height',_this.$contentWrapContainer.height());$('#fixed-backtotop').fadeOut(function() {this.parentNode.removeChild(this);});_this.$el.fadeOut();_this.xhr=$.ajax({type:'get',url:url.withIgn(),dataType:'html',success:function(data) {fifa.cacheMap.set(cached_key,data);fillDataCallback(data);}});}},coreOnReinit:function() {this.$contentWrapContainer=$('#content-wrap>.container');},coreOnPageScroll:function() {var _this=this;if(_this.has_mouseover) { return;}_this.$el.removeClass('hover');},name:'horizontal:view',model_name:'horizontal'});w.views.horizontal=new horizontalView({el:'.horizontal-nav-items',bind:['pageLoad','wrapPrepare','teamsPrepare','horizontal:validCollection','core:reinit','core:pageScroll']});}(window.jQuery||window.jm,window,document));;; (function(factory) {this.NProgress=factory();})(function() {var NProgress={};NProgress.version='0.1.3';var Settings=NProgress.settings={minimum:0.08,easing:'ease',positionUsing:'',speed:200,trickle:true,trickleRate:0.02,trickleSpeed:800,showSpinner:true,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};NProgress.configure=function(options) {var key,value;for (key in options) {value=options[key];if(value!==undefined&&options.hasOwnProperty(key)) Settings[key]=value;}return this;};NProgress.status=null;NProgress.set=function(n) {var started=NProgress.isStarted();n=clamp(n,Settings.minimum,1);NProgress.status=(n===1 ? null:n);var progress=NProgress.render(!started),bar=progress.querySelector(Settings.barSelector),speed=Settings.speed,ease=Settings.easing;progress.offsetWidth;queue(function(next) {if(Settings.positionUsing==='') Settings.positionUsing=NProgress.getPositioningCSS();css(bar,barPositionCSS(n,speed,ease));if(n===1) {css(progress,{transition:'none',opacity:1});progress.offsetWidth;setTimeout(function() {css(progress,{transition:'all ' + speed + 'ms linear',opacity:0});setTimeout(function() {NProgress.remove();next();},speed);},speed);}else {setTimeout(next,speed);}});return this;};NProgress.isStarted=function() {return typeof NProgress.status==='number';};NProgress.start=function() {if(!NProgress.status) NProgress.set(0);var work=function() {setTimeout(function() {if(!NProgress.status) return;NProgress.trickle();work();},Settings.trickleSpeed);};if(Settings.trickle) work();return this;};NProgress.done=function(force) {if(!force&&!NProgress.status) return this;return NProgress.inc(0.3 + 0.5 * Math.random()).set(1);};NProgress.inc=function(amount) {var n=NProgress.status;if(!n) {return NProgress.start();}else {if(typeof amount!=='number') {amount=(1 - n) * clamp(Math.random() * n,0.1,0.95);}n=clamp(n + amount,0,0.994);return NProgress.set(n);}};NProgress.trickle=function() {return NProgress.inc(Math.random() * Settings.trickleRate);};(function() {var initial=0,current=0;NProgress.promise=function($promise) {if(!$promise||$promise.state()=="resolved") {return this;}if(current==0) {NProgress.start();}initial++;current++;$promise.always(function() {current--;if(current==0) {initial=0;NProgress.done();}else {NProgress.set((initial - current) / initial);}});return this;};})();NProgress.render=function(fromStart) {if(NProgress.isRendered()) return document.getElementById('nprogress');addClass(document.documentElement,'nprogress-busy');var progress=document.createElement('div');progress.id='nprogress';progress.innerHTML=Settings.template;var bar=progress.querySelector(Settings.barSelector),perc=fromStart ? '-100':toBarPerc(NProgress.status||0),spinner;css(bar,{transition:'all 0 linear',transform:'translate3d(' + perc + '%,0,0)'});if(!Settings.showSpinner) {spinner=progress.querySelector(Settings.spinnerSelector);spinner&&removeElement(spinner);}document.body.appendChild(progress);return progress;};NProgress.remove=function() {removeClass(document.documentElement,'nprogress-busy');var progress=document.getElementById('nprogress');progress&&removeElement(progress);};NProgress.isRendered=function() {return!!document.getElementById('nprogress');};NProgress.getPositioningCSS=function() {var bodyStyle=document.body.style;var vendorPrefix=('WebkitTransform' in bodyStyle) ? 'Webkit':('MozTransform' in bodyStyle) ? 'Moz':('msTransform' in bodyStyle) ? 'ms':('OTransform' in bodyStyle) ? 'O':'';if(vendorPrefix + 'Perspective' in bodyStyle) {return 'translate3d';}else if(vendorPrefix + 'Transform' in bodyStyle) {return 'translate';}else {return 'margin';}};function clamp(n,min,max) {if(n<min) return min;if(n>max) return max;return n;}function toBarPerc(n) {return (-1 + n) * 100;}function barPositionCSS(n,speed,ease) {var barCSS;if(Settings.positionUsing==='translate3d') {barCSS={ transform:'translate3d(' + toBarPerc(n) + '%,0,0)'};}else if(Settings.positionUsing==='translate') {barCSS={ transform:'translate(' + toBarPerc(n) + '%,0)'};}else {barCSS={ 'margin-left':toBarPerc(n) + '%'};}barCSS.transition='all ' + speed + 'ms ' + ease;return barCSS;}var queue=(function() {var pending=[];function next() {var fn=pending.shift();if(fn) {fn(next);}}return function(fn) {pending.push(fn);if(pending.length==1) next();};})();var css=(function() {var cssPrefixes=['Webkit','O','Moz','ms'],cssProps={};function camelCase(string) {return string.replace(/^-ms-/,'ms-').replace(/-([\da-z])/gi,function(match,letter) {return letter.toUpperCase();});}function getVendorProp(name) {var style=document.body.style;if(name in style) return name;var i=cssPrefixes.length,capName=name.charAt(0).toUpperCase() + name.slice(1),vendorName;while (i--) {vendorName=cssPrefixes[i] + capName;if(vendorName in style) return vendorName;}return name;}function getStyleProp(name) {name=camelCase(name);return cssProps[name]||(cssProps[name]=getVendorProp(name));}function applyCss(element,prop,value) {prop=getStyleProp(prop);element.style[prop]=value;}return function(element,properties) {var args=arguments,prop,value;if(args.length==2) {for (prop in properties) {value=properties[prop];if(value!==undefined&&properties.hasOwnProperty(prop)) applyCss(element,prop,value);}}else {applyCss(element,args[1],args[2]);}}})();function hasClass(element,name) {var list=typeof element=='string' ? element:classList(element);return list.indexOf(' ' + name + ' ')>=0;}function addClass(element,name) {var oldList=classList(element),newList=oldList + name;if(hasClass(oldList,name)) return;element.className=newList.substring(1);}function removeClass(element,name) {var oldList=classList(element),newList;if(!hasClass(element,name)) return;newList=oldList.replace(' ' + name + ' ',' ');element.className=newList.substring(1,newList.length - 1);}function classList(element) {return (' ' + (element.className||'') + ' ').replace(/\s+/gi,' ');}function removeElement(element) {element&&element.parentNode&&element.parentNode.removeChild(element);}return NProgress;}); });
